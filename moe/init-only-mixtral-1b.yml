# Initialize Mixtral-1B MoE model with random weights (no training)
# This will create the model, save it, and exit

base_model: mistralai/Mixtral-8x7B-v0.1  # Use as tokenizer source
model_type: AutoModelForCausalLM
tokenizer_type: AutoTokenizer

# Enable random initialization from config
random_init_weights: true

# Model architecture configuration for ~1B parameters
model_config:
  model_type: mixtral
  vocab_size: 32000
  hidden_size: 1024          # Reduced from 4096
  intermediate_size: 3584    # Reduced from 14336 (3.5x hidden_size)
  num_hidden_layers: 16      # Reduced from 32
  num_attention_heads: 16    # Reduced from 32
  num_key_value_heads: 4     # Reduced from 8 (GQA)
  
  # MoE configuration (keeping similar ratios)
  num_experts_per_tok: 2     # Same as original
  num_local_experts: 8       # Same as original (8 experts)
  output_router_logits: true
  router_aux_loss_coef: 0.001
  
  # Context and other settings
  max_position_embeddings: 4096
  sliding_window: 2048       # Smaller window
  rope_theta: 1000000.0
  attention_dropout: 0.0
  hidden_dropout: 0.0
  
  # Activation function
  hidden_act: "silu"
  
  # Normalization
  rms_norm_eps: 1e-5
  
  # Initialize with reasonable values
  initializer_range: 0.02

trust_remote_code: true

# NO TRAINING - just save the initialized model
datasets: []  # Empty dataset list
max_steps: 0  # No training steps
save_model: true
output_dir: ./outputs/mixtral-1b-moe-init

# Required batch settings (even though we're not training)
micro_batch_size: 1
gradient_accumulation_steps: 1

# Skip all training-related settings
skip_data_loading: true

# Just save and exit
logging_steps: 1
save_steps: 1
save_total_limit: 1

# Additional Configuration
strict: false
debug: true